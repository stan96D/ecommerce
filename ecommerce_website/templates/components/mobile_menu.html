{% load static %}

<!-- Mobile Menu (Initially hidden) -->
<div
  id="mobile-menu"
  class="fixed inset-0 bg-white shadow-lg z-50 hidden overflow-y-auto"
>
  <div class="flex flex-col p-4">
    <!-- Logo or other items if needed -->
    <div class="flex items-center justify-between">
      <img
        src="{% static 'images/gvs_logo_plain_cropped.jpg' %}"
        alt="Logo"
        class="w-64 h-auto"
      />
      <!-- Close Button (X) -->
      <button class="text-gray-400 p-2" onclick="toggleMobileMenu()">
        <svg
          class="w-6 h-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          ></path>
        </svg>
      </button>
    </div>

    <!-- User Account & Favorites (Hidden on small screens) -->
    <div class="flex space-x-4 mt-4 justify-between w-full">
      <div class="flex space-x-4">
        {% if user.is_authenticated %}
          <a href="{% url 'account' %}">
            <button
              type="button"
              class="flex-shrink-0 rounded-full p-1 text-gray-400 hover:text-gray-300 w-10 h-10"
            >
              <span class="sr-only">Account</span>
              <i class="far fa-user fa-lg"></i>
            </button>
          </a>
        {% endif %}

        <!-- Favorite icon -->
        <button
          type="button"
          onclick="openFavorites()"
          class="flex-shrink-0 rounded-full p-1 text-gray-400 hover:text-gray-300 w-10 h-10 relative"
        >
          <span class="sr-only">Favorite</span>
          <i class="far fa-heart fa-lg"></i>
          <!-- Favorite count (positioned correctly) -->
          <span
            id="favorite-count-mobile"
            class="absolute top-0 right-0 -mt-2 -mr-2 bg-green-600 rounded-full w-6 h-6 flex items-center justify-center text-white text-xs font-semibold"
          ></span>
        </button>
      </div>

      <!-- Contact Email Button (Aligned to the right) -->
      {% if store_data and store_data.contact_email %}
        <div class="ml-auto sm:flex-shrink-0">
          <a
            href="mailto:{{ store_data.contact_email }}"
            class="inline-flex items-center rounded-full border-2 border-transparent bg-gradient-to-r from-orange-500 to-orange-400 px-6 py-2 text-sm font-medium text-white hover:from-orange-600 hover:to-orange-600 focus:outline-none focus:ring-2 focus:ring-orange-400 focus:ring-offset-2 transform transition-all duration-300 ease-in-out hover:scale-105 w-full sm:w-auto"
          >
            <!-- Icon (Visible on md and larger) -->
            <i class="fas fa-envelope text-lg md:inline hidden"></i>
          </a>
        </div>
      {% endif %}
    </div>
    <hr class="mt-4 border-gray-200" />

    <!-- Horizontal Line (Divider) Below Header -->
    <!-- Categories Dropdown (for mobile, can be expanded) -->
    <div class="space-y-4 py-2 mt-4">
      {% for category in headerData %}
        <div class="relative">
          <a href="/products/{{ category.name }}" class="w-full text-left">
            <button
              class="w-full text-left px-4 py-2 text-gray-800 hover:bg-gray-100"
            >
              {{ category.name }}
            </button>
          </a>
        </div>
      {% endfor %}
    </div>

    <!-- Login/Register & Logout Buttons -->
    <div class="px-4 pt-8 ">
      {% if user.is_authenticated %}
        <a
          href="/logout"
          class="block w-full text-center bg-orange-500 text-white py-2 rounded-md hover:bg-orange-400"
        >
          Uitloggen
        </a>
      {% else %}
        <a
          href="/login"
          class="block w-full text-center bg-orange-500 text-white py-2 rounded-md hover:bg-orange-400"
        >
          Inloggen
        </a>
        <a
          href="/registration"
          class="text-sm font-medium text-gray-400 hover:text-gray-300 block w-full text-center py-4"
        >
          Account aanmaken
        </a>
      {% endif %}
    </div>
  </div>
</div>

<!-- JavaScript to handle the menu toggle -->
<script>
  // Function to toggle the visibility of the mobile menu
  function toggleMobileMenu() {
    const menu = document.getElementById('mobile-menu')
    const body = document.body
    menu.classList.toggle('hidden') // Toggle the "hidden" class to show/hide the menu
    if (menu.classList.contains('hidden')) {
      body.style.overflow = '' // Restore scroll when menu is closed
    } else {
      body.style.overflow = 'hidden' // Prevent background scrolling when menu is open
    }
  }
</script>
